\section{Discretization and code framework}