\section{Results}
\label{sec:results}

\subsection{2D Euler equations with a one dimensional uncertainty}
We start by quantifying the effects of an uncertain angle of attack $\phi\sim U(0.75,1.75)$ for a NACA0012 profile computed with different methods. The stochastic Euler equations in two dimensions are given by
\begin{align*}
\partial_t
\begin{pmatrix}
\rho \\ \rho v_1 \\ \rho v_2 \\ \rho e
\end{pmatrix}
+\partial_{x_1}
\begin{pmatrix}
\rho v_1 \\ \rho v_1^2 +p \\ \rho v_1 v_2 \\  v_1 (\rho e+p)
\end{pmatrix}
+\partial_{x_2}
\begin{pmatrix}
\rho v_2 \\ \rho v_1 v_2 \\ \rho v_2^2+p \\ v_2 (\rho e+p)
\end{pmatrix}
=\bm{0}.
\end{align*}
These equations determine the time evolution of the conserved variables $(\rho,\rho \bm v, \rho e)$, i.e. density, momentum and energy. A closure for the pressure $p$ is given by
\begin{align*}
p = (\gamma-1)\rho\left(e-\frac12(v_1^2+v_2^2)\right).
\end{align*}
Since the the fluid of the following test cases is air, we choose the heat capacity ratio $\gamma$ to be $1.4$. The spatial mesh discretizes the flow domain around the airfoil. At the airfoil boundary $\Gamma_{0}$, we use the Euler slip condition $\bm v^T\bm n = 0$, where $\bm n$ denotes the surface normal. At a sufficiently large distance away from the airfoil, we assume a far field flow with a given Mach number $Ma = 0.8$, pressure $p = 101\;325$ Pa and a temperature of $273.15$ K. Now the angle of attack $\phi$ is uniformly distributed in the interval of $[0.75,1.75]$ degrees. I.e. we choose $\phi(\xi) = 1.25 + 0.5\xi$ where $\xi\sim U(-1,1)$. As commonly done, the initial condition is equal to the far field boundary values. Consequently, the wall condition at the airfoil is violated and will correct the flow solution. The computational domain is a circle with a diameter of $40$ meters. In the center, the NACA0012 airfoil with a length of one meter is located. The discretization is composed of a coarsely refined far field and a finely resolved region around the airfoil, since we are interested in the flow solution at the airfoil. Altogether, the mesh consists of 22361 triangular elements.

The aim is to quantify the effects arising from the one-dimensional uncertainty $\xi$ with different methods. The IPM methods makes use of the acceleration strategies proposed in this work. To be able to measure the quality of the obtained solutions, we compute a reference solution using stochastic-Collocation with $100$ Gauss-Lobatto quadrature points. In the following, we investigate the L$^2$ error of the variance and the expectation value. The L$^2$ of the discrete quantity $\bm e_{\Delta}=(\bm e_1,\cdots,\bm e_{N_x})^T$, where $\bm e_j$ denotes the cell average in spatial cell $j$ is denoted by
\begin{align*}
\Vert \bm e_{\Delta} \Vert_{\Delta} := \sqrt{\sum_{j=1}^{N_x} \Delta x_j \bm e_j^2}
\end{align*}
Hence, when denoting the reference solution by $\bm u_{\Delta}$ and the moments obtained with the numerical method by $\hat{\bm u}_{\Delta}$, we investigate the relative error
\begin{align*}
\frac{\Vert E[\bm u_{\Delta}] - E[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}{\Vert E[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert} \qquad \text{ and }\qquad \frac{\Vert Var[\bm u_{\Delta}] - Var[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}{\Vert Var[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}.
\end{align*}
The error is computed inside a box of one meter height and 1.1 meters length around the airfoil to prevent small fluctuations in the coarsely refined far field from affecting the error.

The quantities of interests are now computed with the different methods. All methods in this section have been computed using five MPI threads. For more information on the chosen entropy and the resulting solution ansatz for IPM, see \ref{app:IPM2DEuler}. 

\begin{figure}[h!]
\centering
\centering
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.544]{figs/StudyQuadrature/{L2_error_E[rho]}.pdf}
		\caption{}
		\label{fig:ErrorDifferentQuadA}
	\end{subfigure}%
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.544]{figs/StudyQuadrature/{L2_error_Var[rho]}.pdf}
		\caption{}
		\label{fig:ErrorDifferentQuadB}
	\end{subfigure}
	\caption{Relative L$^2$ error with different quadrature levels. The subscript denotes the moment order, the superscript denotes the Clenshaw-Curtis quadrature level.}
	\label{fig:ErrorDifferentQuad}
\end{figure}

Recall that the numerical flux \eqref{eq:numericalFluxIPM} uses a quadrature rule to approximate integrals. We start by investigating the effects this quadrature has on the solution accuracy. For this, we run the IPM method with a moment order ranging from three to seven using a Clenshaw-Curtis quadrature rule with level three (i.e. 9 quadrature points) and level four (i.e. 17 quadrature points). A comparison of the error obtained with these two quadrature levels is given in Figure~\ref{fig:ErrorDifferentQuad}. When for example comparing the error obtained with IPM$_8^3$ and IPM$_8^4$ it can be seen that the error stagnates when the chosen quadrature is not sufficiently accurate. This behavior results from aliasing effects in the numerical flux, which dominate the accuracy level. Furthermore, Figure~\ref{fig:ErrorDifferentQuadA} reveals that the IPM error of E[$\rho$] with 9 quadrature points stagnates at the error level of SC$^9$, whereas the error of the variance in Figure~\ref{fig:ErrorDifferentQuadB} shows that IPM with 9 quadrature points yields an improved variance results over SC$^9$ even with only four moments. Hence, the number of moments needed for IPM to obtain a certain variance error is significantly smaller than the number of quadrature points needed for SC. This result will show throughout the results of this work. Especially for high dimensional problems, this potentially decreases the number of unknowns to reach a certain accuracy level significantly. However note, that since the numerical flux evaluation requires $O(N\cdot Q)$ evaluations, the numerical costs will depend on the chosen quadrature rule.

Let us now compare stochastic-Collocation with stochastic-Galerkin and IPM at a fixed moment order 9 as well as its proposed acceleration techniques. Note that since IPM generalizes SG, all proposed techniques can be used for this method as well. All intrusive methods are iterated until the expectation value of the density fulfills the stopping criterion \eqref{eq:residualSteady} with $\varepsilon = 5\cdot 10^{-6}$, however it can be seen that the error saturates already at a bigger residual. For every quadrature point, SC iterates the solution until the density reaches a certain residual level $\varepsilon$.  We observed that the SC error requires a smaller residual level to reach a constant state and we have recorded this behavior in the following table for the SC$^{17}$ solution.
\begin{center}
\begin{tabular}{ | m{3cm} || m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | m{0.9cm} | } 
\hline
residual $\rho$ & 5e-06 & 4e-06 & 3e-06 & 2e-06 & 1e-06 & 9e-07 & 8e-07 & 7e-07 & 6e-07 & 5e-07  \\ 
\hline
error E[$\rho$] in e-03 & 1.506 & 1.464 & 1.438 & 1.401 & 1.368 & 1.360 & 1.359 & 1.358 & 1.358 & 1.357  \\ 
\hline
error Var[$\rho$] in e-03 & 1.339 & 1.332 & 1.292 & 1.248 & 1.217 & 1.215 & 1.214 & 1.213 & 1.213 & 1.213  \\ 
\hline
\end{tabular}
\end{center}
Hence, we can deduce that SC requires a smaller
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_E[rho]}.pdf}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_Var[rho]}.pdf}
		\label{fig:sub2}
	\end{subfigure}
	
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_E[rhoE]}.pdf}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_Var[rhoE]}.pdf}
		\label{fig:sub2}
	\end{subfigure}
	\caption{Relative L$^2$ error with 5 MPI threads for density and energy.}
	\label{fig:L2ErrorSolution}
\end{figure}

First, let us mention that the adaptive SG method fails, since it yields negative densities during the iteration. The standard SG method however preserves positivity of mass, energy and pressure. The change of the relative L$^2$ error during the iteration to the steady state has been recorded in Figure~\ref{fig:L2ErrorSolution}. Note that in the case of SC, the error cannot be recorded without violating the non-intrusive framework and adding extra costs, which is why we only plot the final error and the corresponding run time. To account for the fact that sparse grids need to be used in high dimensional problems, we use Clenshaw-Curtis quadrature rules to compute the different solutions. Stochastic-Collocation uses quadrature levels $2,3$ and $4$, which corresponds to $5,9$ and $17$ quadrature points. All adaptive methods use gPC polynomials of order 2 to 9 (i.e. 3 to 10 moments). Order 2 uses a level 2, orders 3 to 6 use a level 3 and orders 8 and 9 use a level 4 quadrature rule. The remaining methods have been computed with a level 4 quadrature rule. 


First, it sticks out that again, the intrusive methods yield a smaller error level for the same number of unknowns compared to SC. For the same number of unknowns, the run time of the intrusive methods is always bigger than the corresponding SC method. However, the error of SG and IPM lies in the area of SC$^{17}$ at which the adaptive method has a smaller run time than SC. While SG shows a slightly better approximation of the expectation value, IPM shows a smaller error of the variance. When comparing the different methods without acceleration techniques, 







 and compare against Collocation with $5$ collocation points as well as SG and IPM with $5$ moments and $10$ quadrature points. Furthermore, we use convergence accelerated (caIPM) as well as convergence accelerated one-shot IPM (caosIPM), which we introduced in Sections \ref{sec:collIPM} and \ref{sec:OneShotIPM} with $10$ moments and $15$ quadrature points to converge the collocation solution with $5$ quadrature points to an entropy solution with increased accuracy.



\newgeometry{top=1.5cm, left=1.0cm}
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.15]{figs/Euler1DPlots5/{sc100_ERho}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.15]{figs/Euler1DPlots5/{sc100_VarRho}.png}
		\label{fig:sub2}
	\end{subfigure}
	\caption{Reference solution E$[\rho]$ and Var$[\rho]$.}
	\label{fig:L2ErrorSolution}
\end{figure}
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{EulerSC5-2Res1e-6_ERho}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{sg_4_9_ERho}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{osIPM4-4_ERho}.png}
		\label{fig:sub1}
	\end{subfigure}
	
		\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{EulerSC5-2Res1e-6_VarRho}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{sg_4_9_VarRho}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots5/{osIPM4-4_VarRho}.png}
		\label{fig:sub1}
	\end{subfigure}
	\caption{E$[\rho]$ and Var$[\rho]$ computed with SC$^5$, SG$_5$, IPM$_5$ (from left to right).}
	\label{fig:ERhoVarRho5}
\end{figure}

\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots10/{euler2D_nacaCoarse_refadosipm_n2-9_sg2-4_s05_aoa_oneRet_ERho}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots10/{euler2D_nacaCoarse_refadosipm_n2-9_sg2-4_s05_aoa_oneRet_VarRho}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/Euler1DPlots10/{euler2D_nacaCoarse_refadosipm_n2-9_sg2-4_s05_aoa_oneRet_refinementLevel}.png}
		\label{fig:sub1}
	\end{subfigure}
	\caption{E$[\rho]$, Var$[\rho]$ and refinement level for readosIPM$_{2-9}$}
	\label{fig:ERhoVarRho5}
\end{figure}

\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
				\includegraphics[scale=0.2]{figs/Euler1DPlots10/{EulerSC4-17Res1e-6_errors_ERho}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
				\includegraphics[scale=0.2]{figs/Euler1DPlots10/{euler2D_nacaCoarse_sg_n9_sg4_s05_aoa_errors_ERho}.png}
		\label{fig:sub2}
	\end{subfigure}%
		\begin{subfigure}{0.33\linewidth}
		\centering
				\includegraphics[scale=0.2]{figs/Euler1DPlots10/{euler2D_nacaCoarse_ipm_n9_sg4_s05_aoa_errors_ERho}.png}
		\label{fig:sub2}
	\end{subfigure}
	\caption{Errors E$[\rho]$ for SC$^{17}$, SG$_{10}$, IPM$_{10}$ (from left to right).}
	\label{fig:ErrorsERho}
\end{figure}
\newgeometry{top=2.5cm, left=2.5cm}