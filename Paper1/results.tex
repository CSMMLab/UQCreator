\section{Results}
\label{sec:results}

\subsection{2D Euler equations with a one dimensional uncertainty}
We start by quantifying the effects of an uncertain angle of attack $\phi\sim U(0.75,1.75)$ for a NACA0012 profile computed with different methods. The stochastic Euler equations in two dimensions are given by
\begin{align*}
\partial_t
\begin{pmatrix}
\rho \\ \rho v_1 \\ \rho v_2 \\ \rho e
\end{pmatrix}
+\partial_{x_1}
\begin{pmatrix}
\rho v_1 \\ \rho v_1^2 +p \\ \rho v_1 v_2 \\  v_1 (\rho e+p)
\end{pmatrix}
+\partial_{x_2}
\begin{pmatrix}
\rho v_2 \\ \rho v_1 v_2 \\ \rho v_2^2+p \\ v_2 (\rho e+p)
\end{pmatrix}
=\bm{0}.
\end{align*}
These equations determine the time evolution of the conserved variables $(\rho,rho \bm v, rho e)$, i.e. density, momentum and energy. A closure for the pressure $p$ is given by
\begin{align*}
p = (\gamma-1)\rho\left(e-\frac12(v_1^2+v_2^2)\right).
\end{align*}
Since the the fluid of the following test cases is air, we choose the heat capacity ratio $\gamma$ to be $1.4$. The spatial mesh discretizes the flow domain around the airfoil. At the airfoil boundary $\Gamma_{0}$, we use the Euler slip condition $\bm v^T\bm n = 0$, where $\bm n$ denotes the surface normal. At a sufficiently large distance away from the airfoil, we assume a far field flow with a given Mach number $Ma = 0.8$, pressure $p = 101\;325$ Pa and a temperature of $273.15$ K. Now the angle of attack $\phi$ is uniformly distributed in the interval of $[0.75,1.75]$ degrees. I.e. we choose $\phi(\xi) = 1.25 + 0.5\xi$ where $\xi\sim U(-1,1)$. As commonly done, the initial condition is equal to the far field boundary values. Consequently, the wall condition at the airfoil is violated and will correct the flow solution. The computational domain is a circle with a diameter of $40$ meters. In the center, the NACA0012 airfoil with a length of one meter is located. The discretization is composed of a coarsely refined far field and a finely resolved region around the airfoil, since we are interested in the flow solution at the airfoil. Altogether, the mesh consists of 22361 triangular elements.

The aim is to quantify the effects arising from the one-dimensional uncertainty $\xi$ with different methods. The IPM methods makes use of the acceleration strategies proposed in this work. To be able to measure the quality of the obtained solutions, we compute a reference solution using stochastic-Collocation with $100$ Gauss-Lobatto quadrature points. In the following, we investigate the L$^2$ error of the variance and the expectation value. The L$^2$ of the discrete quantity $\bm e_{\Delta}=(\bm e_1,\cdots,\bm e_{N_x})^T$, where $\bm e_j$ denotes the cell average in spatial cell $j$ is denoted by
\begin{align*}
\Vert \bm e_{\Delta} \Vert_{\Delta} := \sqrt{\sum_{j=1}^{N_x} \Delta x_j \bm e_j^2}
\end{align*}
Hence, when denoting the reference solution by $\bm u_{\Delta}$ and the moments obtained with the numerical method by $\hat{\bm u}_{\Delta}$, we investigate the relative error
\begin{align*}
\frac{\Vert E[\bm u_{\Delta}] - E[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}{\Vert E[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert} \qquad \text{ and }\qquad \frac{\Vert Var[\bm u_{\Delta}] - Var[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}{\Vert Var[\mathcal{U}(\bm{\hat u}_{\Delta})] \Vert}.
\end{align*}
The error is computed inside a box of one meter height and 1.1 meters length around the airfoil to prevent small fluctuations in the coarsely refined far field from affecting the error.

The quantities of interests are now computed with the different methods. All methods in this section have been computed using five MPI threads. For more information on the chosen entropy and the resulting solution ansatz for IPM, see \ref{app:IPM2DEuler}. 

Recall that the numerical flux \eqref{eq:numericalFluxIPM} uses a quadrature rule to approximate integrals. We start by investigating the effects this quadrature has on the solution accuracy. For this, we run the IPM method with a moment order ranging from three to seven \comment{[use IPM instead of osIPM, add accuracy of SC$^3$]} using a Clenshaw-Curtis quadrature rule with level three (i.e. 9 quadrature points) and level four (i.e. 17 quadrature points). The results are given in Figure TODO. It can be seen that the error stagnates when the chosen quadrature is not sufficiently accurate. This behavior results from aliasing effects, which dominate the accuracy level. Note that SC can be interpreted as an intrusive method which uses as many moments as quadrature points to compute the numerical flux. Therefore, we can conclude that the error of SC is dominated by aliasing effects and will not reach the same accuracy level as an intrusive method with a sufficiently accurate quadrature rule. Especially for high dimensional problems, this potentially decreases the number of unknowns to reach a certain accuracy level significantly. However note, that since the numerical flux evaluation requires $O(N\cdot Q)$ evaluations, the numerical costs will depend on the chosen quadrature rule.

Let us now compare stochastic-Collocation with stochastic-Galerkin and IPM as well as its proposed acceleration techniques. Note that since IPM generalizes SG, all proposed techniques can be used for this method as well. The methods are iterated until the expectation value of the density fulfills the stopping criterion \eqref{eq:residualSteady} with $\varepsilon = 10^{-5}$. Note that the adaptive SG method fails, since it yields negative densities during the iteration. The standard SG method however remains in the admissible set. The change of the relative L$^2$ error during the iteration to the steady state has been recorded in Figure~\ref{fig:Obstacles2D}.
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_E[rho]}.pdf}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.5\linewidth}
		\centering
				\includegraphics[scale=0.55]{figs/errorEuler/{L2_error_Var[rho]}.pdf}
		\label{fig:sub2}
	\end{subfigure}
	\caption{Relative L$^2$ error with 5 MPI threads.}
	\label{fig:Obstacles2D}
\end{figure}

Note that in the case of SC, the error cannot be recorded without destroying the non-intrusive framework and adding extra costs, which is why we only plot the final error and the corresponding run time. To account for the fact that sparse grids need to be used in higher dimensions, we use Clenshaw-Curtis quadrature rules to compute the different solutions. Stochasti-Collocation uses quadrature levels 2,3 and 4, which corresponds to 5,9 and 17 quadrature points. All adaptive methods use gPC polynomials of order 2 to 9 (i.e. 3 to 10 moments). Order 2 uses a level 2, orders 3 to 6 use a level 3 and orders 8 and 9 use a level 4 quadrature rule. The remaining methods have been computed with a level 4 quadrature rule.

First, it sticks out that again, the intrusive methods yield a smaller error level for the same number of unknowns compared to SC. For the same number of unknowns, the run time of the intrusive methods is always bigger than the corresponding SC method. However, the error of SG and IPM lies in the area of SC$^{17}$ at which the adaptive method has a smaller run time that SC. \comment{SG kann nicht schneller sein als SC17} While SG shows a slightly better approximation of the expectation value, IPM shows a smaller error of the variance. When comparing the different methods without acceleration techniques, 

 and compare against Collocation with $5$ collocation points as well as SG and IPM with $5$ moments and $10$ quadrature points. Furthermore, we use convergence accelerated (caIPM) as well as convergence accelerated one-shot IPM (caosIPM), which we introduced in Sections \ref{sec:collIPM} and \ref{sec:OneShotIPM} with $10$ moments and $15$ quadrature points to converge the collocation solution with $5$ quadrature points to an entropy solution with increased accuracy.

\begin{figure}[h!]
\centering
		\centering
		\includegraphics[scale=0.7]{figs/{L2_error_E[rho]osIPMIPMCol}.pdf}
		\label{fig:sub1}
	\caption{L2 error at airfoil with 5 MPI and 2 OMP threads.}
	\label{fig:Obstacles2D}
\end{figure}

\begin{figure}[h!]
\centering
		\centering
		\includegraphics[scale=0.7]{figs/{L2_error_E[rho]}.pdf}
		\label{fig:sub1}
	\caption{L2 error at airfoil with 5 MPI and 2 OMP threads.}
	\label{fig:Obstacles2D}
\end{figure}

\begin{figure}[h!]
\centering
		\centering
		\includegraphics[scale=0.7]{figs/{convergence_runtime_residual}.pdf}
		\label{fig:sub1}
	\caption{Convergence to steady state with 5 MPI and 2 OMP threads.}
	\label{fig:Obstacles2D}
\end{figure}

\newgeometry{top=1.5cm, left=1.0cm}
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_sc_n5_s05_aoa}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_sg_n5_nq10_s05_aoa}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_ipm_n5_nq10_s05_aoa}.png}
		\label{fig:sub1}
	\end{subfigure}
	
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_caipm_n10_nq15_s05_aoa}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_caosipm_n10_nq15_s05_aoa}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/{euler2D_nacaCoarse_sc_n50_s05_aoa_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\caption{E$[\rho]$ (from top left to bottom right) SC, SG, IPM, caIPM, caosIPM, reference solution.}
	\label{fig:Obstacles2D}
\end{figure}

\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_sc_n5_s05_aoa_var}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_sg_n5_nq10_s05_aoa_var}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_ipm_n5_nq10_s05_aoa_var}.png}
		\label{fig:sub1}
	\end{subfigure}
	
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_caipm_n10_nq15_s05_aoa_var}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_caosipm_n10_nq15_s05_aoa_var}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/{euler2D_nacaCoarse_sc_n50_s05_aoa_var_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\caption{Var$[\rho]$ (from top left to bottom right) SC, SG, IPM, caIPM, caosIPM, reference solution.}
	\label{fig:Obstacles2D}
\end{figure}

%%% error plots %%%
\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/errors/{euler2D_nacaCoarse_sc_n5_s05_aoa_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/errors/{euler2D_nacaCoarse_sg_n5_nq10_s05_aoa_error_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/errors/{euler2D_nacaCoarse_ipm_n5_nq10_s05_aoa_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}
	
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/errors/{euler2D_nacaCoarse_caipm_n10_nq15_s05_aoa_error_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/expectedRho/errors/{euler2D_nacaCoarse_caosipm_n10_nq15_s05_aoa_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}
	\caption{E$[\rho]$ distance to reference solution (from top left to bottom right) SC, SG, IPM, caIPM, caosIPM.}
	\label{fig:Obstacles2D}
\end{figure}

\begin{figure}[h!]
\centering
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/errors/{euler2D_nacaCoarse_sc_n5_s05_aoa_var_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/errors/{euler2D_nacaCoarse_sg_n5_nq10_s05_aoa_var_error_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/errors/{euler2D_nacaCoarse_ipm_n5_nq10_s05_aoa_var_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}
	
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/errors/{euler2D_nacaCoarse_caipm_n10_nq15_s05_aoa_var_error_legend}.png}
		\label{fig:sub2}
	\end{subfigure}%
	\begin{subfigure}{0.33\linewidth}
		\centering
		\includegraphics[scale=0.2]{figs/varRho/errors/{euler2D_nacaCoarse_caosipm_n10_nq15_s05_aoa_var_error_legend}.png}
		\label{fig:sub1}
	\end{subfigure}
	\caption{Var$[\rho]$ distance to reference solution (from top left to bottom right) SC, SG, IPM, caIPM, caosIPM.}
	\label{fig:Obstacles2D}
\end{figure}
\newgeometry{top=2.5cm, bottom=2.5cm}